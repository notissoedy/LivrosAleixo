<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BLOG - BILLIONAIRE-EBOOKS</title>
  <meta name="description"
    content="Explore artigos incrÃ­veis sobre livros, educaÃ§Ã£o, leitura e desenvolvimento pessoal no blog BILLIONAIRE-EBOOKS" />
  <meta name="keywords" content="blog, livros, leitura, desenvolvimento pessoal, educaÃ§Ã£o, BILLIONAIRE-EBOOKS">
  <meta name="author" content="BILLIONAIRE-EBOOKS">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">
  <style>
    body {
      background: linear-gradient(to right, #1e1e2f, #2a2a40);
      color: #f0f0f0;
    }

    .box {
      background-color: transparent;
      color: #e0e0e0;
      border: 1px solid #2a2a2a;
    }

    .button.is-link {
      background: linear-gradient(135deg, #4b6cb7, #182848);
      border: none;
      color: white;
    }

    .blog-post img,
    .image-preview {
      max-width: 100%;
      border-radius: 8px;
    }

    .search-bar input {
      background-color: #2a2a2a;
      color: #fff;
      border: 1px solid #444;
    }

    .search-bar input::placeholder {
      color: #aaa;
    }

    .has-text-grey {
      color: #aaa !important;
    }
  </style>

<style>
  body,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  p,
  span,
  a,
  li,
  label,
  input,
  button,
  strong,
  em,
  figcaption {
    color: #f0f0f0 !important;
  }

  a.navbar-item,
  .navbar-item,
  .navbar-link {
    color: #f0f0f0 !important;
  }

  input::placeholder {
    color: #ccc !important;
  }

  .box {
    border: 1px solid #444;
    /* antes estava muito escura */
  }

  .navbar-menu,.navbar { background-color:  #2a2a2a !important; }
</style>

  <script>
    // Ativa o menu mobile
    document.addEventListener("DOMContentLoaded", () => {
      const $navbarBurgers = Array.from(document.querySelectorAll(".navbar-burger"));

      $navbarBurgers.forEach(el => {
        el.addEventListener("click", () => {
          const target = document.getElementById(el.dataset.target);
          el.classList.toggle("is-active");
          target.classList.toggle("is-active");
        });
      });
    });
  </script>


</head>

<body>
  <!-- Navbar -->
  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a class="navbar-item" href="index.html">
        ðŸ“š <strong>BILLIONAIRE-EBOOKS</strong>
      </a>

      <!-- BotÃ£o hamburguer (mobile) -->
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarMenu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="navbarMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="home.html">Home</a>
        <a class="navbar-item" href="blog.html">Blog</a>
      </div>

      <div class="navbar-end">
        <div class="navbar-item">
          <span id="user-email" class="mr-2"></span>
          <div class="buttons">
            <button class="button is-link" id="loginBtn">Login</button>
            <button class="button is-danger is-light" id="logoutBtn" style="display:none;">Logout</button>
          </div>
        </div>
      </div>
    </div>
  </nav>


  <section class="section">
    <div class="container">
      <h1 class="title is-3 has-text-centered ">BLOG <br /> BILLIONAIRE-EBOOKS</h1>

      <div class="field has-addons search-bar">
        <div class="control is-expanded">
          <input id="searchInput" class="input" type="text"
            placeholder="Buscar por tÃ­tulo, categoria ou palavra-chave...">
        </div>
        <div class="control">
          <button id="searchBtn" class="button is-link">Buscar</button>
        </div>
      </div>

      <h2 class="title is-4">Artigo em destaque</h2>
      <div id="artigoPrincipal" class="box blog-post"></div>

      <h2 class="title is-4 mt-6">Artigos relacionados</h2>
      <div id="artigosRelacionados" class="columns is-multiline"></div>
    </div>
  </section>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBHcbcRZ98WOHEQu9t2qnjLHP9Wvz_ggPs",
      authDomain: "aleixobook.firebaseapp.com",
      projectId: "aleixobook",
      storageBucket: "aleixobook.appspot.com",
      messagingSenderId: "989202118697",
      appId: "1:989202118697:web:508c40a7acfbbf80dcc438"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let allPosts = [];

    async function carregarPosts(filtro = "") {
      const snap = await getDocs(collection(db, "blog-posts"));
      allPosts = [];
      snap.forEach(doc => allPosts.push({ id: doc.id, ...doc.data() }));
      allPosts.sort((a, b) => new Date(b.data) - new Date(a.data));

      const postsFiltrados = allPosts.filter(post => {
        const termo = filtro.toLowerCase();
        return (
          post.titulo.toLowerCase().includes(termo) ||
          post.categoria.toLowerCase().includes(termo) ||
          post.palavrasChave.toLowerCase().includes(termo)
        );
      });

      renderizarPosts(postsFiltrados);
    }

    function slugify(str) {
      return str.toLowerCase()
        .normalize('NFD').replace(/\p{Diacritic}/gu, '')
        .replace(/[^a-z0-9]+/g, '-')
        .replace(/^-+|-+$/g, '');
    }

    function renderizarPosts(posts) {
      const principal = posts[0];
      const containerPrincipal = document.getElementById("artigoPrincipal");
      const containerRelacionados = document.getElementById("artigosRelacionados");

      containerPrincipal.innerHTML = principal ? `
        <article>
          <h2 class="title is-4">${principal.titulo}</h2>
          <figure>
            <img src="${principal.imagem}" alt="Imagem de capa" class="image-preview">
            <figcaption class="has-text-grey">${principal.legenda}</figcaption>
          </figure>
          <p class="is-size-7"><strong>Categoria:</strong> ${principal.categoria}</p>
          <p class="is-size-7"><strong>Palavras-chave:</strong> ${principal.palavrasChave}</p>
          <div class="mt-2">${principal.conteudo.slice(0, 300)}...</div>
          <a class="button is-link is-small mt-3" href="post.html?id=${principal.id}&titulo=${slugify(principal.titulo)}">Ler mais</a>
        </article>` : '<p>Nenhum post encontrado.</p>';

      containerRelacionados.innerHTML = "";
      posts.slice(1, 5).forEach(post => {
        const col = document.createElement("div");
        col.className = "column is-6-tablet is-4-desktop";
        col.innerHTML = `
          <div class="box">
            <h3 class="title is-6">${post.titulo}</h3>
            <figure>
              <img src="${post.imagem}" alt="Imagem relacionada" class="image-preview">
            </figure>
            <p class="is-size-7 has-text-grey">${post.legenda}</p>
            <p class="is-size-7">Categoria: ${post.categoria}</p>
            <a href="post.html?id=${post.id}&titulo=${slugify(post.titulo)}" class="button is-small is-link mt-2">Ver detalhes</a>
          </div>
        `;
        containerRelacionados.appendChild(col);
      });
    }

    document.getElementById("searchBtn").onclick = () => {
      const termo = document.getElementById("searchInput").value;
      carregarPosts(termo);
    };

    document.getElementById("searchInput").addEventListener("keypress", e => {
      if (e.key === "Enter") {
        e.preventDefault();
        document.getElementById("searchBtn").click();
      }
    });

    carregarPosts();

    import { getAuth, GoogleAuthProvider, onAuthStateChanged, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const auth = getAuth(app);

    const loginBtn = document.getElementById("loginBtn");
    const logoutBtn = document.getElementById("logoutBtn");
    const userEmail = document.getElementById("user-email");

    onAuthStateChanged(auth, (user) => {
      if (user) {

        loginBtn.style.display = "none";
        logoutBtn.style.display = "inline-block";
        userEmail.textContent = user.email;
      } else {


        loginBtn.style.display = "inline-block";
        logoutBtn.style.display = "none";
        userEmail.textContent = "";
      }
    });

    loginBtn.onclick = () => {
      const provider = new GoogleAuthProvider();
      signInWithPopup(auth, provider).catch((error) => alert("Erro no login: " + error.message));
    };

    logoutBtn.onclick = () => {
      signOut(auth).then(() => location.reload());
    };
  </script>
</body>

</html>