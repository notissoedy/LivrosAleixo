<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Livros Online </title>
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">

</head>
<body>
    <style>
  body {
    //background-color: #f5f5f5; /* Cinza suave */
     background-color: #e0e0e0;
  }
</style>
<!-- header section starts  -->
<header class="header">
    <div class="header-1">

        <a href="#" class="logo"> <i class="fas fa-book"></i> FX-Book </a>

        <form action="" class="search-form">
            <input type="search" name="" placeholder="search here..." id="search-box">
            <label for="search-box" class="fas fa-search"></label>
        </form>

        <div id="icons" class="icons">
            <div id="search-btn" class="fas fa-search"></div>
            <a href="favoritos.html" class="fas fa-heart"></a>
            <a href="#" class="fas fa-shopping-cart"></a>
            <div id="login-btn" class="fas fa-user"></div>
            <div id="loginoutId" class="fas fa-sign-out-alt" onclick="logOut()"></div>
        </div>

    </div>

    <div class="header-2">
        <nav class="navbar">
            <a href="#home">home</a>
            <a href="#featured">featured</a>
            <a href="#arrivals">arrivals</a>
            <a href="#reviews">reviews</a>
            <a href="#blogs">blogs</a>
            <a id="adminLink" href="admin.html">Admin</a>
        </nav>
    </div>

</header>
<!-- header section ends -->

<!-- bottom navbar  -->
<nav class="bottom-navbar">
    <a href="#home" class="fas fa-home"></a>
    <a href="#featured" class="fas fa-list"></a>
    <a href="#arrivals" class="fas fa-tags"></a>
    <a href="#reviews" class="fas fa-comments"></a>
    <a href="#blogs" class="fas fa-blog"></a>
    <a id="adminLink2" href="admin.html" class="fas fa-adjust">admin</a>
</nav>

<!-- login form  -->
<div class="login-form-container">
    <div id="close-login-btn" class="fas fa-times"></div>
  
    <form onsubmit="login(event)">
      <h3>Sign in</h3>
      <span>Email</span>
      <input id="loginEmail" type="email" class="box" placeholder="Enter your email" required>
      <span>Password</span>
      <input id="loginPassword" type="password" class="box" placeholder="Enter your password" required>
      <div class="checkbox">
        <input type="checkbox" id="remember-me">
        <label for="remember-me">Remember me</label>
      </div>
      <input type="submit" value="Sign in" class="btn">
      <p>Forget password? <a href="#" onclick="forgotPassword()">Click here</a></p>
      <p>Don't have an account? <a href="#" onclick="showSignup()">Create one</a></p>
    </form>
  </div>
  

<!-- signup form  -->

<div class="login-form-container signup-form-container">
    <div id="close-signup-btn" class="fas fa-times"></div>

    <form onsubmit="signup(event)">
        <h3>sign up</h3>
        <span>Email</span>
        <input id="signupEmail" type="email" class="box" placeholder="enter your email" required>
        <span>Password</span>
        <input id="signupPassword" type="password" class="box" placeholder="enter your password" required>
        <div class="checkbox">
            <input type="checkbox" id="remember-me">
            <label for="remember-me"> remember me</label>
        </div>
        <input type="submit" value="sign up" class="btn">
        <p>have an account? <a href="#" onclick="showLogin()">login</a></p>
    </form>
</div>

<!-- home section starts  -->

<section class="home" id="home">

    <div class="row">

        <div class="content">
            <h3>Livros de Marketing</h3>
            <p>35% off</p>
            <a href="#featured" class="btn">Comprar Agora</a>
        </div>

        <div class="swiper books-slider">
            <div class="swiper-wrapper" id="imgcapa">
                <a href="#" class="swiper-slide"><img src="image/book4.jpg" alt=""></a>
                <a href="#" class="swiper-slide"><img src="image/book-2.jpg" alt=""></a>
                <a href="#" class="swiper-slide"><img src="image/book3.jpg" alt=""></a>
                <a href="#" class="swiper-slide"><img src="image/book8.jpg" alt=""></a>
                <a href="#" class="swiper-slide"><img src="image/book5.jpg" alt=""></a>
                <a href="#" class="swiper-slide"><img src="image/book-6.jpg" alt=""></a>
            </div>
            <img src="image/stand.png" class="stand" alt="">
        </div>

    </div>

</section>

<!-- home section ense  -->

<!-- icons section starts  -->

<section class="icons-container">

    <div class="icons">
        <i class="fas fa-shipping-fast"></i>
        <div class="content">
            <h3>Entrega grates</h3>
            <p>order over $100</p>
        </div>
    </div>

    <div class="icons">
        <i class="fas fa-lock"></i>
        <div class="content">
            <h3>Pagamento Seguro</h3>
            <p>100 Pagamento Seguro</p>
        </div>
    </div>

    <div class="icons">
        <i class="fas fa-redo-alt"></i>
        <div class="content">
            <h3>Devolucao facel</h3>
            <p>10 days returns</p>
        </div>
    </div>

    <div class="icons">
        <i class="fas fa-headset"></i>
        <div class="content">
            <h3>24/7 support</h3>
            <p>Lige a qualquer hora</p>
        </div>
    </div>

</section>

<!-- icons section ends -->

<!-- featured section starts  -->

<section class="featured" id="c">

    <h1 class="heading"> <span>livros em destaque</span> </h1>

    <div class="swiper featured-slider">

        <div class="swiper-wrapper" id="featured-books">

            <div class="swiper-slide box">
                <div class="icons">
                    <a href="#" class="fas fa-search"></a>
                    <a href="#" class="fas fa-heart"></a>
                    <a href="#" class="fas fa-eye"></a>
                </div>
                <div class="image">
                    <img src="image/book-1.jpg" alt="">
                </div>
                <div class="content">
                    <h3>featured books</h3>
                    <div class="price">$11.99 <span>$14.99</span></div>
                    <a href="#" class="btn">add to cart</a>
                </div>
            </div>

            <div class="swiper-slide box">
                <div class="icons">
                    <a href="#" class="fas fa-search"></a>
                    <a href="#" class="fas fa-heart"></a>
                    <a href="#" class="fas fa-eye"></a>
                </div>
                <div class="image">
                    <img src="image/book-2.jpg" alt="">
                </div>
                <div class="content">
                    <h3>featured books</h3>
                    <div class="price">$17.99 <span>$24.99</span></div>
                    <a href="#" class="btn">add to cart</a>
                </div>
            </div>

            <div class="swiper-slide box">
                <div class="icons">
                    <a href="#" class="fas fa-search"></a>
                    <a href="#" class="fas fa-heart"></a>
                    <a href="#" class="fas fa-eye"></a>
                </div>
                <div class="image">
                    <img src="image/book-3.jpg" alt="">
                </div>
                <div class="content">
                    <h3>featured books</h3>
                    <div class="price">$18.99 <span>$21.99</span></div>
                    <a href="#" class="btn">add to cart</a>
                </div>
            </div>

            

            <div class="swiper-slide box">
                <div class="icons">
                    <a href="#" class="fas fa-search"></a>
                    <a href="#" class="fas fa-heart"></a>
                    <a href="#" class="fas fa-eye"></a>
                </div>
                <div class="image">
                    <img src="image/book-7.jpg" alt="">
                </div>
                <div class="content">
                    <h3>featured books</h3>
                    <div class="price">$22.99 <span>$30.99</span></div>
                    <a href="#" class="btn">add to cart</a>
                </div>
            </div>

            <div class="swiper-slide box">
                <div class="icons">
                    <a href="#" class="fas fa-search"></a>
                    <a href="#" class="fas fa-heart"></a>
                    <a href="#" class="fas fa-eye"></a>
                </div>
                <div class="image">
                    <img src="image/book-8.jpg" alt="">
                </div>
                <div class="content">
                    <h3>featured books</h3>
                    <div class="price">$23.99 <span>$29.99</span></div>
                    <a href="#" class="btn">add to cart</a>
                </div>
            </div>

            <div class="swiper-slide box">
                <div class="icons">
                    <a href="#" class="fas fa-search"></a>
                    <a href="#" class="fas fa-heart"></a>
                    <a href="#" class="fas fa-eye"></a>
                </div>
                <div class="image">
                    <img src="image/book-9.png" alt="">
                </div>
                <div class="content">
                    <h3>featured books</h3>
                    <div class="price">$34.99 <span>$40.99</span></div>
                    <a href="#" class="btn">add to cart</a>
                </div>
            </div>

            <div class="swiper-slide box">
                <div class="icons">
                    <a href="#" class="fas fa-search"></a>
                    <a href="#" class="fas fa-heart"></a>
                    <a href="#" class="fas fa-eye"></a>
                </div>
                <div class="image">
                    <img src="image/book-10.jpg" alt="">
                </div>
                <div class="content">
                    <h3>featured books</h3>
                    <div class="price">$9.99 <span>$14.99</span></div>
                    <a href="#" class="btn">add to cart</a>
                </div>
            </div>

        </div>

        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>

    </div>

</section>

<!-- featured section ends -->

<!-- newsletter section starts -->

<section class="newsletter">

    <form action="">
        <h3>subscribe for latest updates</h3>
        <input type="email" name="" placeholder="enter your email" id="" class="box">
        <input type="submit" value="subscribe" class="btn">
    </form>

</section>

<!-- newsletter section ends -->

<!-- arrivals section starts  -->

<section class="arrivals" id="arrivals">

    <h1 class="heading"> <span>Novidades</span> </h1>

    <div   class="swiper arrivals-slider">
    <div class="swiper-wrapper" id="new-books"> 

            <a href="#" class="swiper-slide box">
                <div class="image">
                    <img src="image/book1.jpg" alt="">
                </div>
                <div class="content">
                    <h3>new arrivals</h3>
                    <div class="price">$12.99 <span>$16.99</span></div>
                    <div class="stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                </div>
            </a>

            <a href="#" class="swiper-slide box">
                <div class="image">
                    <img src="image/book2.jpg" alt="">
                </div>
                <div class="content">
                    <h3>new arrivals</h3>
                    <div class="price">$16.99 <span>$21.99</span></div>
                    <div class="stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                </div>
            </a>


        </div>

    </div>

    <div class="swiper arrivals-slider">

    <div class="swiper-wrapper" id="new2-books"> 

            <a href="#" class="swiper-slide box">
                <div class="image">
                    <img src="image/book6.jpg" alt="">
                </div>
                <div class="content">
                    <h3>new arrivals</h3>
                    <div class="price">$25.99 <span>$30.99</span></div>
                    <div class="stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                </div>
            </a>

            <a href="#" class="swiper-slide box">
                <div class="image">
                    <img src="image/book7.jpg" alt="">
                </div>
                <div class="content">
                    <h3>new arrivals</h3>
                    <div class="price">$7.00 <span>$9.99</span></div>
                    <div class="stars">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                </div>
            </a>


        </div>

    </div>

</section>

<!-- arrivals section ends -->

<!-- deal section starts  -->

<section class="deal">

    <div class="content">
        <h3>Oferta do Dia</h3>
        <h1>Até 50% de desconto </h1>
        <p></p>
        <a href="#" class="btn">Comprar agora</a>
    </div>

    <div class="image">
        <img src="image/deal-img.jpg" alt="">
    </div>

</section>

<!-- deal section ends -->

<!-- reviews section starts  -->

<section class="reviews" id="reviews">

    <h1 class="heading"> <span>client's reviews</span> </h1>

    <div class="swiper reviews-slider">

        <div class="swiper-wrapper">

            <div class="swiper-slide box">
                <img src="image/pic-1.jpg" alt="">
                <h3>Salma</h3>
                <!-- <p>9.5/10</p> -->
                <div class="stars">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star-half-alt"></i>
                </div>
            </div>

            <div class="swiper-slide box">
                <img src="image/pic-2.jpg" alt="">
                <h3>Nawal</h3>
                <!-- <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Aspernatur nihil ipsa placeat. Aperiam at sint, eos ex similique facere hic.</p> -->
                <div class="stars">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star-half-alt"></i>
                </div>
            </div>

            <div class="swiper-slide box">
                <img src="image/pic-3.jpg" alt="">
                <h3>Yusra</h3>
                <!-- <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Aspernatur nihil ipsa placeat. Aperiam at sint, eos ex similique facere hic.</p> -->
                <div class="stars">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star-half-alt"></i>
                </div>
            </div>
          

        </div>

    </div>
    
</section>

<!-- reviews section ends -->

<!-- blogs section starts  -->

<section class="blogs" id="blogs">

    <h1 class="heading"> <span>our blogs</span> </h1>

    <div class="swiper blogs-slider">

        <div class="swiper-wrapper">

            <div class="swiper-slide box">
                <div class="image">
                    <img src="image/blog-1.jpg" alt="">
                </div>
                <div class="content">
                    <h3>blog title goes here</h3>
                    <!-- <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio, odio.</p> -->
                    <a href="#" class="btn">read more</a>
                </div>
            </div>

            <div class="swiper-slide box">
                <div class="image">
                    <img src="image/blog-2.jpg" alt="">
                </div>
                <div class="content">
                    <h3>blog title goes here</h3>
                    <!-- <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio, odio.</p> -->
                    <a href="#" class="btn">read more</a>
                </div>
            </div>

            <div class="swiper-slide box">
                <div class="image">
                    <img src="image/blog-3.jpg" alt="">
                </div>
                <div class="content">
                    <h3>blog title goes here</h3>
                    <!-- <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio, odio.</p> -->
                    <a href="#" class="btn">read more</a>
                </div>
            </div>

            <div class="swiper-slide box">
                <div class="image">
                    <img src="image/blog-4.jpg" alt="">
                </div>
                <div class="content">
                    <h3>blog title goes here</h3>
                    <!-- <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio, odio.</p> -->
                    <a href="#" class="btn">read more</a>
                </div>
            </div>

            <div class="swiper-slide box">
                <div class="image">
                    <img src="image/blog-5.jpg" alt="">
                </div>
                <div class="content">
                    <h3>blog title goes here</h3>
                    <!-- <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio, odio.</p> -->
                    <a href="#" class="btn">read more</a>
                </div>
            </div>

        </div>

    </div>

</section>

<!-- blogs section ends -->

<!-- footer section starts  -->

<section class="footer">

    <div class="box-container">

        <div class="box">
            <h3>our locations</h3>
            <a href="#"> <i class="fas fa-map-marker-alt"></i> Mozambique </a>
            <a href="#"> <i class="fas fa-map-marker-alt"></i> USA </a>
            <a href="#"> <i class="fas fa-map-marker-alt"></i> russia </a>
            <a href="#"> <i class="fas fa-map-marker-alt"></i> england </a>
            <a href="#"> <i class="fas fa-map-marker-alt"></i> japan </a>
            <a href="#"> <i class="fas fa-map-marker-alt"></i> france </a>
        </div>

        <div class="box">
            <h3>quick links</h3>
            <a href="#home"> <i class="fas fa-arrow-right"></i> home </a>
            <a href="#featured"> <i class="fas fa-arrow-right"></i> destaque </a>
            <a href="#arrivals"> <i class="fas fa-arrow-right"></i> arrivals </a>
            <a href="#reviews"> <i class="fas fa-arrow-right"></i> reviews </a>
            <a href="#blogs"> <i class="fas fa-arrow-right"></i> blogs </a>
        </div>

        <div class="box">
            <h3>extra links</h3>
            <a href="#"> <i class="fas fa-arrow-right"></i> Perfil </a>
            <a href="#"> <i class="fas fa-arrow-right"></i> Encomendados </a>
            <a href="#"> <i class="fas fa-arrow-right"></i> Politica de privacidade </a>
            <a href="#"> <i class="fas fa-arrow-right"></i> Metodos de pagamentos </a>
            <a href="#"> <i class="fas fa-arrow-right"></i> Nossos Servicos </a>
        </div>

        <div class="box">
            <h3>contactos</h3>
            <!-- <a href="#"> <i class="fas fa-phone"></i> +123-456-7890 </a> -->
            <a href="#"> <i class="fas fa-phone"></i> +258 848373303 </a>
            <a href="#"> <i class="fas fa-envelope"></i> aleixoaleixoalfredo9@gmail.com </a>
            <img src="image/worldmap.png" class="map" alt="">
        </div>
        
    </div>

    <div class="share">
        <a href="https://www.facebook.com/profile.php?id=100006540690109"target="_blank" class="fab fa-facebook-f"></a>
        <a href="https://github.com/AhmedGamal710" target="_blank" class="fab fa-github"></a>
        <a href="https://www.instagram.com/ahmed_gamal710/" target="_blank"class="fab fa-instagram"></a>
        <a href="https://www.linkedin.com/in/ahmed-gamal-199a161a4/"target="_blank" class="fab fa-linkedin"></a>
        <a href="https://wa.me/qr/AAMR4RL5B7MRL1" target="_blank" class="fab fa-whatsapp"></a>
    </div>

    <div class="credit"> created by <span>Notisso</span></div>

</section>

<!-- footer section ends -->

<!-- loader  -->

<div class="loader-container">
    <img src="image/loader-img.gif" alt="">
    <!-- <img src="image/loader-img.jpg" alt=""> -->

</div>
















<script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>

<!-- custom js file link  -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    // import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { getFirestore, collection, getDocs, doc, getDoc, updateDoc, arrayUnion, arrayRemove } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import {
    getAuth,
    signInWithEmailAndPassword,
    sendPasswordResetEmail,onAuthStateChanged,createUserWithEmailAndPassword  } 
    from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import {  } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBHcbcRZ98WOHEQu9t2qnjLHP9Wvz_ggPs",
      authDomain: "aleixobook.firebaseapp.com",
      projectId: "aleixobook",
      storageBucket: "aleixobook.firebasestorage.app",
      messagingSenderId: "989202118697",
      appId: "1:989202118697:web:508c40a7acfbbf80dcc438"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const renderBooks = (containerId, books) => {
      const container = document.getElementById(containerId);
      container.innerHTML = "";
      books.forEach(doc => {
        const data = doc.data();
        const slide = document.createElement("a");
        slide.className = "swiper-slide box";
        slide.href=`livro.html?id=${doc.id}&categoria=new`;
        slide.target="_blank";
        slide.innerHTML = `
                <div class="image">
                    <img src="${data.capa}" alt="${data.titulo}">
                </div>
                <div class="content">
                    <h3>${data.titulo}</h3>
                    <div class="price"> ${data.preco} <span> ${data.preco}</span></div>
                    <div class="stars">
                    
                        ${"<i class='fas fa-star'></i>".repeat(data.estrelas || 0)}
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                </div>
        `;
      
        container.appendChild(slide);
      });
    };

    

    function renderBooks2(containerId, books, userSnap) {
  const container = document.getElementById(containerId);
  container.innerHTML = "";
  const favoritos = userSnap?.data()?.favoritos || [];

  books.forEach(doc => {
    const data = doc.data();
    const isFavorito = favoritos.includes(doc.id);
    const heartClass = isFavorito ? "has-text-danger" : "";

    const slide = document.createElement("div");
    slide.className = "swiper-slide box";
    slide.innerHTML = `
      <div class="icons">
        <a href="#featured" class="fas fa-search"></a>
        <a href="#featured" class="fas fa-heart ${heartClass}" onclick="toggleFavorite('${doc.id}', 'featured', this)"></a>
        <a href="livro.html?id=${doc.id}&categoria=featured" class="fas fa-eye"></a>
      </div>
      <div class="image">
        <img src="${data.capa}" alt="${data.titulo}">
      </div>
      <div class="content">
        <h3>${data.titulo}</h3>
        <div class="price"> ${data.novoPreco} <span> ${data.preco}</span></div>
        <a href="livro.html?id=${doc.id}&categoria=featured" class="btn">Comprar</a>
      </div>
    `;
    container.appendChild(slide);
  });
}

    const renderBooks3 = (containerId, books) => {
      const container = document.getElementById(containerId);
      container.innerHTML = "";
      books.forEach(doc => {
        const data = doc.data();
        const slide = document.createElement("a");
        slide.className = "swiper-slide";
        slide.href=`livro.html?id=${doc.id}&categoria=new2`;
        slide.innerHTML = `
                 <img src="${data.capa}" alt="${data.titulo}">
        `;
      
        container.appendChild(slide);
      });
    };

    async function carregarLivros() {
         const adminEmails = ["notissoedy@gmail.com", "notissoedydev2@gmail.com", "aleixoaleixoalfredo9@gmail.com"];

  const auth = getAuth();
  const adminLink = document.getElementById('adminLink');
  const adminLink2 = document.getElementById('adminLink2');

  onAuthStateChanged(auth, async (user) => {

    if (user && adminEmails.includes(user.email)) {
   
       adminLink.style.display = "inline-block";
       adminLink2.style.display = "inline-block";


    } else {
       adminLink.style.display = "none";
       adminLink2.style.display = "none";
    }

    let userSnap = null;

    if (user) {
      const docRef = doc(db, "usuarios", user.uid);
      const snapshot = await getDoc(docRef);
      userSnap = snapshot.exists() ? snapshot : null;

       loginoutId.style.display = "inline-block";
    }else {
            // Ninguém autenticado
            
           loginoutId.style.display = "none";
    }

    const [featuredSnap, newSnap, new2Snap] = await Promise.all([
      getDocs(collection(db, "livros-featured")),
      getDocs(collection(db, "livros-new")),
      getDocs(collection(db, "livros-new2"))
    ]);

    renderBooks2("featured-books", featuredSnap.docs, userSnap);
    renderBooks("new-books", newSnap.docs);
    renderBooks("new2-books", new2Snap.docs);
    renderBooks3("imgcapa", new2Snap.docs);
    initSwipers();
  });
}

    carregarLivros();

  

// Função de cadastro
const signup = async function (event) {
    event.preventDefault();

    const email = document.getElementById("signupEmail").value;
    const password = document.getElementById("signupPassword").value;

    try {
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;

      // Salvar info adicional no Firestore
      await setDoc(doc(db, "usuarios", user.uid), {
        email: email,
        dataRegistro: serverTimestamp(),
        livrosComprados: [],
        favoritos: []
      });

      alert("Cadastro realizado com sucesso!");
      // Redirecionar ou fechar formulário
    } catch (error) {
      console.error("Erro no cadastro:", error.message);
      alert("Erro: " + error.message);
    }
  };

  window.signup = signup;

     // 🔐 Função de login
     const login = async (event) => {
    event.preventDefault(); // evita recarregar página

    const email = document.getElementById("loginEmail").value.trim();
    const password = document.getElementById("loginPassword").value;

    try {
      const userCredential = await signInWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;

      alert("Login realizado com sucesso!");
      // Redirecionar ou esconder login-form
      document.querySelector(".login-form-container").classList.remove("active");

    } catch (error) {
      console.error(error);
      alert("Erro no login: " + error.message);
    }
  };
  window.login = login;
  // 🔐 Recuperação de senha
  const forgotPassword = async () => {
    const email = prompt("Digite seu email para recuperar a senha:");
    if (!email) return;

    try {
      await sendPasswordResetEmail(auth, email);
      alert("Link de recuperação enviado para seu email!");
    } catch (error) {
      alert("Erro ao enviar email: " + error.message);
    }
  };

  window.forgotPassword = forgotPassword;

  const logOut = async () => {
   signOut(auth).then(() => {
    alert("Você saiu da conta.");
  }).catch((error) => {
    console.error("Erro ao sair:", error);
  });
  };

  window.logOut = logOut;

  
 
  // Exibe o formulário de cadastro
  const showSignup = () => {
    document.querySelector('.login-form-container').classList.remove('active');
    document.querySelector('.signup-form-container').classList.add('active');


  };

  window.showSignup= showSignup;

  // Exibe o formulário de cadastro
  const showLogin = () => {
    document.querySelector('.login-form-container').classList.add('active');
    document.querySelector('.signup-form-container').classList.remove('active');

  };

  window.showLogin= showLogin;

// Função para curtir/descurtir
async function toggleFavorite(livroId, categoria, element) {
  const user = auth.currentUser;
  if (!user) {
    alert("Você precisa estar logado para favoritar.");
    showLogin(); // exibe formulário de login
    return;
  }

  const userRef = doc(db, "usuarios", user.uid);
  const livroRef = doc(db, `livros-${categoria}`, livroId);

  try {
    const userSnap = await getDoc(userRef);
    const livroSnap = await getDoc(livroRef);

    if (!livroSnap.exists()) {
      alert("Livro não encontrado.");
      return;
    }

    const favoritos = userSnap.exists() && userSnap.data().favoritos || [];
    const jaFavoritado = favoritos.some(fav => fav.id === livroId && fav.categoria === categoria);

    console.log(element);
  

    if (jaFavoritado) {
      await updateDoc(userRef, {
        favoritos: arrayRemove({ id: livroId, categoria })
      });
      alert("Removido dos favoritos.");
      element.classList.replace("fas", "far"); // ícone não preenchido
      element.title = "Adicionar aos favoritos";
    } else {
      await updateDoc(userRef, {
        favoritos: arrayUnion({ id: livroId, categoria })
      });
      alert("Adicionado aos favoritos!");
      element.classList.replace("far", "fas"); // ícone preenchido
      element.title = "Remover dos favoritos";
    }
  } catch (err) {
    console.error("Erro ao favoritar livro:", err);
    alert("Erro ao atualizar favoritos.");
  }
}
window.toggleFavorite = toggleFavorite;


  </script>

<script src="js/script.js"></script>

</body>
</html>